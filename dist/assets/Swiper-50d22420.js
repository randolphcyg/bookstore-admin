import{_ as j,r as P,d as V,x as z,y as R,C as $,o as m,c as E,w as a,b as g,f as l,e as D,i as f,F as d,j as p,J as N,K as A,m as M,k as q,h as G,n as B,L as J,z as K,M as L,E as O,N as U,D as Q,O as H,P as W,Q as X,R as Y,S as Z,T as ee}from"./index-a28300c9.js";/* empty css             *//* empty css               *//* empty css              *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  *//* empty css                 */const te=["src"],le={class:"dialog-footer"},oe=f("取 消"),ae=f("确 定"),re={__name:"DialogAddSwiper",props:{type:String,reload:Function},setup(h,{expose:u}){const t=h,n=P(null),e=V({uploadImgServer:z,token:R("token")||"",visible:!1,ruleForm:{url:"",link:"",sort:""},rules:{url:[{required:"true",message:"图片不能为空",trigger:["change"]}],sort:[{required:"true",message:"排序不能为空",trigger:["change"]}]},id:""}),b=r=>{p.get(`/carousels/${r}`).then(o=>{e.ruleForm={url:o.carouselUrl,link:o.redirectUrl,sort:o.carouselRank}})},k=r=>{const o=r.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(o))return d.error("请上传 jpg、jpeg、png 格式的图片"),!1},y=r=>{e.ruleForm.url=r.data||""},s=r=>{e.visible=!0,r?(e.id=r,b(r)):e.ruleForm={url:"",link:"",sort:""}},S=()=>{e.visible=!1},_=()=>{console.log(n.value.validate),n.value.validate(r=>{r&&(t.type==="add"?p.post("/carousels",{carouselUrl:e.ruleForm.url,redirectUrl:e.ruleForm.link,carouselRank:e.ruleForm.sort}).then(()=>{d.success("添加成功"),e.visible=!1,t.reload&&t.reload()}):p.put("/carousels",{carouselId:e.id,carouselUrl:e.ruleForm.url,redirectUrl:e.ruleForm.link,carouselRank:e.ruleForm.sort}).then(()=>{d.success("修改成功"),e.visible=!1,t.reload&&t.reload()}))})};return u({open:s,close:S}),(r,o)=>{const v=$("Plus"),w=N,F=A,i=M,x=q,I=G,C=B,T=J;return m(),E(T,{title:h.type==="add"?"添加轮播图":"修改轮播图",modelValue:e.visible,"onUpdate:modelValue":o[3]||(o[3]=c=>e.visible=c),width:"400px"},{footer:a(()=>[g("span",le,[l(C,{onClick:o[2]||(o[2]=c=>e.visible=!1)},{default:a(()=>[oe]),_:1}),l(C,{type:"primary",onClick:_},{default:a(()=>[ae]),_:1})])]),default:a(()=>[l(I,{model:e.ruleForm,rules:e.rules,ref_key:"formRef",ref:n,"label-width":"100px",class:"book-form"},{default:a(()=>[l(i,{label:"图片",prop:"url"},{default:a(()=>[l(F,{class:"avatar-uploader",action:e.uploadImgServer,accept:"jpg,jpeg,png",headers:{token:e.token},"show-file-list":!1,"before-upload":k,"on-success":y},{default:a(()=>[e.ruleForm.url?(m(),D("img",{key:0,style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"},src:e.ruleForm.url,class:"avatar",alt:""},null,8,te)):(m(),E(w,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[l(v)]),_:1}))]),_:1},8,["action","headers"])]),_:1}),l(i,{label:"跳转链接",prop:"link"},{default:a(()=>[l(x,{type:"text",modelValue:e.ruleForm.link,"onUpdate:modelValue":o[0]||(o[0]=c=>e.ruleForm.link=c)},null,8,["modelValue"])]),_:1}),l(i,{label:"排序值",prop:"sort"},{default:a(()=>[l(x,{type:"number",modelValue:e.ruleForm.sort,"onUpdate:modelValue":o[1]||(o[1]=c=>e.ruleForm.sort=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},se=j(re,[["__scopeId","data-v-0711a244"]]),ne={class:"header"},ie=f("增加"),ce=f("批量删除"),ue=["src"],de=["href"],Fe={__name:"Swiper",setup(h){const u=P(),t=V({loading:!1,tableData:[],currentPage:1,pageSize:10,type:"add",multipleSelection:[],total:0});K(()=>{n()});const n=()=>{t.loading=!0,p.get("/carousels",{params:{pageNumber:t.currentPage,pageSize:t.pageSize}}).then(s=>{t.tableData=s.list,t.total=s.totalCount,t.currentPage=s.currPage,t.loading=!1})},e=()=>{console.log("addSwiper",u.value),t.type="add",u.value.open()},b=s=>{t.multipleSelection=s},k=()=>{if(!t.multipleSelection.length){d.error("请选择项");return}p.delete("/carousels",{data:{ids:t.multipleSelection.map(s=>s.carouselId)}}).then(()=>{d.success("删除成功"),n()})},y=s=>{t.currentPage=s,n()};return(s,S)=>{const _=B,r=H,o=W,v=X,w=Y,F=O;return m(),D(L,null,[l(F,{class:"swiper-container"},{header:a(()=>[g("div",ne,[l(_,{type:"primary",icon:U(Z),onClick:e},{default:a(()=>[ie]),_:1},8,["icon"]),l(r,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:k},{reference:a(()=>[l(_,{type:"danger",icon:U(ee)},{default:a(()=>[ce]),_:1},8,["icon"])]),_:1})])]),default:a(()=>[l(v,{load:t.loading,ref:"multipleTable",data:t.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:b},{default:a(()=>[l(o,{type:"selection",width:"55"}),l(o,{label:"轮播图",width:"200"},{default:a(i=>[g("img",{style:{width:"150px",height:"150px"},src:i.row.carouselUrl,alt:"轮播图"},null,8,ue)]),_:1}),l(o,{label:"跳转链接"},{default:a(i=>[g("a",{target:"_blank",href:i.row.redirectUrl},Q(i.row.redirectUrl),9,de)]),_:1}),l(o,{prop:"carouselRank",label:"排序值",width:"120"}),l(o,{prop:"createTime",label:"添加时间",width:"200"})]),_:1},8,["load","data"]),l(w,{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage,onCurrentChange:y},null,8,["total","page-size","current-page"])]),_:1}),l(se,{ref_key:"addSwiper",ref:u,reload:n,type:t.type},null,8,["type"])],64)}}};export{Fe as default};
