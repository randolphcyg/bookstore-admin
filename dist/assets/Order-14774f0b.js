import{d as D,z as O,j as m,C as B,o as n,c as p,w as r,E as M,b as c,f as a,e as _,Y as F,M as L,N as b,D as U,Z as S,i as g,F as d,k as j,$ as q,n as Q,P as R,O as Y,Q as Z,R as A,a0 as w,T as G,a1 as H}from"./index-a28300c9.js";/* empty css             *//* empty css               *//* empty css              *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   */const J={class:"header"},K=g("配货完成"),W=g("出库"),X=g("关闭订单"),ee={key:0},te={key:1},oe={key:2},le=c("a",{style:{cursor:"pointer","margin-right":"10px"}},"配货完成",-1),ae=c("a",{style:{cursor:"pointer","margin-right":"10px"}},"出库",-1),re=c("a",{style:{cursor:"pointer","margin-right":"10px"}},"关闭订单",-1),ne=g("订单详情"),fe={__name:"Order",setup(se){const e=D({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,orderNo:"",orderStatus:"",options:[{value:"",label:"全部"},{value:0,label:"待支付"},{value:1,label:"已支付"},{value:2,label:"配货完成"},{value:3,label:"出库成功"},{value:4,label:"交易成功"},{value:-1,label:"手动关闭"},{value:-2,label:"超时关闭"},{value:-3,label:"商家关闭"}]});O(()=>{u()});const u=()=>{e.loading=!0,m.get("/orders",{params:{pageNumber:e.currentPage,pageSize:e.pageSize,orderNo:e.orderNo,orderStatus:e.orderStatus}}).then(l=>{e.tableData=l.list,e.total=l.totalCount,e.currentPage=l.currPage,e.loading=!1})},y=()=>{e.currentPage=1,u()},E=l=>{e.multipleSelection=l},N=l=>{e.currentPage=l,u()},C=l=>{let o;if(l)o=[l];else{if(!e.multipleSelection.length){console.log("state.multipleSelection",e.multipleSelection.length),d.error("请选择项");return}o=e.multipleSelection.map(s=>s.orderId)}m.put("/orders/checkDone",{ids:o}).then(()=>{d.success("配货成功"),u()})},v=l=>{let o;if(l)o=[l];else{if(!e.multipleSelection.length){d.error("请选择项");return}o=e.multipleSelection.map(s=>s.orderId)}m.put("/orders/checkOut",{ids:o}).then(()=>{d.success("出库成功"),u()})},k=l=>{let o;if(l)o=[l];else{if(!e.multipleSelection.length){d.error("请选择项");return}o=e.multipleSelection.map(s=>s.orderId)}m.put("/orders/close",{ids:o}).then(()=>{d.success("关闭成功"),u()})};return(l,o)=>{const s=j,P=H,V=q,f=Q,i=R,h=Y,I=B("router-link"),T=Z,$=A,z=M;return n(),p(z,{class:"order-container"},{header:r(()=>[c("div",J,[a(s,{style:{width:"200px","margin-right":"10px"},placeholder:"请输入订单号",modelValue:e.orderNo,"onUpdate:modelValue":o[0]||(o[0]=t=>e.orderNo=t),onChange:y,clearable:""},null,8,["modelValue"]),a(V,{onChange:y,modelValue:e.orderStatus,"onUpdate:modelValue":o[1]||(o[1]=t=>e.orderStatus=t),style:{width:"200px","margin-right":"10px"}},{default:r(()=>[(n(!0),_(L,null,F(e.options,t=>(n(),p(P,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(f,{type:"primary",icon:b(w),onClick:o[2]||(o[2]=t=>C())},{default:r(()=>[K]),_:1},8,["icon"]),a(f,{type:"primary",icon:b(w),onClick:o[3]||(o[3]=t=>v())},{default:r(()=>[W]),_:1},8,["icon"]),a(f,{type:"danger",icon:b(G),onClick:o[4]||(o[4]=t=>k())},{default:r(()=>[X]),_:1},8,["icon"])])]),default:r(()=>[a(T,{load:e.loading,data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:E},{default:r(()=>[a(i,{type:"selection",width:"55"}),a(i,{prop:"orderNo",label:"订单号"}),a(i,{prop:"totalPrice",label:"订单总价"}),a(i,{prop:"orderStatus",label:"订单状态"},{default:r(t=>[c("span",null,U(l.$filters.orderMap(t.row.orderStatus)),1)]),_:1}),a(i,{prop:"payType",label:"支付方式"},{default:r(t=>[t.row.payType===1?(n(),_("span",ee,"微信支付")):t.row.payType===2?(n(),_("span",te,"支付宝支付")):(n(),_("span",oe,"未知"))]),_:1}),a(i,{prop:"createTime",label:"创建时间"}),a(i,{label:"操作"},{default:r(t=>[t.row.orderStatus===1?(n(),p(h,{key:0,title:"确定配货完成吗？",onConfirm:x=>C(t.row.orderId),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:r(()=>[le]),_:2},1032,["onConfirm"])):S("",!0),t.row.orderStatus===2?(n(),p(h,{key:1,title:"确定出库吗？",onConfirm:x=>v(t.row.orderId),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:r(()=>[ae]),_:2},1032,["onConfirm"])):S("",!0),t.row.orderStatus===4||t.row.orderStatus<0?S("",!0):(n(),p(h,{key:2,title:"确定关闭订单吗？",onConfirm:x=>k(t.row.orderId),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:r(()=>[re]),_:2},1032,["onConfirm"])),a(I,{to:{path:"/order_detail",query:{id:t.row.orderId}}},{default:r(()=>[ne]),_:2},1032,["to"])]),_:1})]),_:1},8,["load","data"]),a($,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:N},null,8,["total","page-size","current-page"])]),_:1})}}};export{fe as default};
